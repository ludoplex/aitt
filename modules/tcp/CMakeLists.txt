SET(AITT_TCP aitt-transport-tcp)

INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})

IF(PLATFORM STREQUAL "tizen")
    PKG_CHECK_MODULES(AITT_TCP_NEEDS REQUIRED openssl1.1)
ELSEIF( NOT PLATFORM STREQUAL "android")
    PKG_CHECK_MODULES(AITT_TCP_NEEDS REQUIRED openssl)
ENDIF(PLATFORM STREQUAL "tizen")

INCLUDE_DIRECTORIES(${AITT_TCP_NEEDS_INCLUDE_DIRS})
LINK_DIRECTORIES(${AITT_TCP_NEEDS_LIBRARY_DIRS})

ADD_LIBRARY(TCP_OBJ OBJECT TCP.cc TCPServer.cc AESEncryptor.cc)
ADD_LIBRARY(${AITT_TCP} SHARED $<TARGET_OBJECTS:TCP_OBJ> ../transport_entry.cc Module.cc)

TARGET_LINK_LIBRARIES(${AITT_TCP} Threads::Threads ${AITT_COMMON} ${AITT_TCP_NEEDS_LIBRARIES})

INSTALL(TARGETS ${AITT_TCP} DESTINATION ${CMAKE_INSTALL_LIBDIR})

IF(BUILD_TESTING)
    ADD_SUBDIRECTORY(samples)
    ADD_SUBDIRECTORY(tests)
ENDIF(BUILD_TESTING)
